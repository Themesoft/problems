<%= simple_form_for @project, :html => { :multipart => true } do |f| %>
<div class="content-wrapper content-wrapper-grey wrapper">
  <div class="content">
    <!--Sidebar - Left-->
    <div class="sidebar-left">
      <!--Box Status-->
      <div class="box-status">
        <form action="#">
          <div class="form-group">
            <%= f.input :status, label: 'Status', collection: Project::STATUSES.zip((0..2).to_a), input_html: { class: 'form-control input-sm' } %>
            <%= f.button :submit, 'SAVE', class: 'btn btn-primary', id: 'project-button' unless @edit %>
          </div>
        </form>
      </div>
      <!--/.Box Status-->
      <!--Box - Resource-->
      <%= f.simple_fields_for :project_attachments do |builder| %>
      <div class="box-resources">
        <div class="title-container">
          <div class="title-icon">
            <i class="fa fa-file-text-o"></i>
          </div>
          <div class="title-caption">Resources</div>
        </div>
        <!-- data-url attribute used to set ajax file upload path -->
        <div class="resource-drag-upload" data-url="upload.php" id="resources-upload">
          <a class="upload-trigger" href="javascript:void(0);">
            <span></span>
          </a>
        </div>
        <%= builder.input :resource, as: :file , class: "hidden" %>
        <div class="resource-items">
          <div class="resource-items-title">Or choose a ﬁle...</div>
          <div class="resource-item">
            <span class="resource-item-caption">Resource 1</span>
            <a class="resource-item-close" href="#">
              <i class="fa fa-times-circle"></i>
            </a>
          </div>
          <div class="resource-item">
            <span class="resource-item-caption">Resource 2</span>
            <a class="resource-item-close" href="#">
              <i class="fa fa-times-circle"></i>
            </a>
          </div>
          <div class="resource-item">
            <span class="resource-item-caption">Resource 3</span>
            <a class="resource-item-close" href="#">
              <i class="fa fa-times-circle"></i>
            </a>
          </div>
          <div class="resource-item">
            <span class="resource-item-caption">Resource 4</span>
            <a class="resource-item-close" href="#">
              <i class="fa fa-times-circle"></i>
            </a>
          </div>
        </div>
      </div>
      <% end %>
      <!--/.Box - Resource-->
      <!--Box - Tags-->
      <div class="box-tags">
        <div class="title-container">
          <div class="title-icon">
            <i class="fa fa-file-text-o"></i>
          </div>
          <div class="title-caption">Tags</div>
        </div>
        <div class="tags-container">
          <div class="box-tags-caption">TAGS</div>
          <div class="tag-items">
            <div class="tag-item">
              <span class="tag-caption">This is a Tag...</span>
              <a class="tag-close" href="#">
                <i class="fa fa-times-circle"></i>
              </a>
            </div>
            <div class="tag-item">
              <span class="tag-caption">This is a Tag...</span>
              <a class="tag-close" href="#">
                <i class="fa fa-times-circle"></i>
              </a>
            </div>
            <div class="tag-item">
              <span class="tag-caption">This is a Tag...</span>
              <a class="tag-close" href="#">
                <i class="fa fa-times-circle"></i>
              </a>
            </div>
            <div class="tag-item">
              <span class="tag-caption">This is a Tag...</span>
              <a class="tag-close" href="#">
                <i class="fa fa-times-circle"></i>
              </a>
            </div>
            <div class="tag-item">
              <span class="tag-caption">This is a Tag...</span>
              <a class="tag-close" href="#">
                <i class="fa fa-times-circle"></i>
              </a>
            </div>
          </div>

          <form action="#" class="add-tag">
            <input class="form-control" type="text"/>
            <button class="btn btn-primary">Add Tag</button>
          </form>

        </div>
      </div>
      <!--/.Box - Tags-->
    </div>
    <!--Sidebar - Left -->

    <!--Panel Content-->
    <div class="panel-content">
      <!--Panel - Green-->
      <div class="panel-green" id="important-stuff">
        <div class="panel-title-container">
          <div class="panel-icon">
            <i class="fa fa-star-o"></i>
          </div>
          <div class="panel-title">The Important Stuff</div>
        </div>
        <div class="image-content">
          <div class="image-content-caption">FEATURED IMAGE</div>
          <!-- data-url attribute used to set ajax file upload path -->
          <div class="image-container" data-url="upload.php" id="important-stuff-upload">
            <%= f.input :featured_image, as: :file, label: false, class: "hidden" %>
          </div>
          <div class="image-options">
            <div class="row">
              <div class="col-xs-6 text-left">Filename. ext</div>
              <div class="col-xs-6 text-right action-links">
                <a class="upload-trigger" href="javascript:void(0);">
                  <i class="fa fa-cloud-upload"></i>
                </a>
                <a href="#">
                  <i class="fa fa-pencil"></i>
                </a>
                <a href="#">
                  <i class="fa fa-trash-o"></i>
                </a>
              </div>
            </div>
          </div>
        </div>
        <div class="form-content form-horizontal">
          <div class="form-group">
            <div class="col-xs-12 col-sm-6  form-field">
              <label>NAME OF PROBLEM</label>
              <input class="form-control" type="text"/>
              <%= f.input :name, label: false, input_html: { class: 'form-control' } %>
            </div>
            <div class="col-xs-12 col-sm-6  form-field">
              <label>TYPE OF PROBLEM</label>
              <%= f.input :type, label: false, input_html: { class: 'form-control' } %>
            </div>
            <div class="col-xs-12 col-sm-6  form-field">
              <label>CONTRIBUTOR NAME</label>
              <%= f.input :author_name, label: false, input_html: { class: 'form-control' } %>
            </div>
            <div class="col-xs-12 col-sm-6  form-field">
              <label>LINK TO AUTHOR’S PAGE</label>
              <%= f.input :author_link, label: false, input_html: { class: 'form-control' } %>
            </div>
            <div class="col-xs-12 col-sm-6  form-field">
              <label>PROBLEM STATEMENT</label>
              <%= f.input :problem_statement, label: false, input_html: { class: 'form-control' } %>
            </div>
            <div class="col-xs-12 col-sm-6  form-field">
              <label>HOOK</label>
              <%= f.input :content, label: false, input_html: { class: 'form-control' } %>
            </div>
          </div>
        </div>
      </div>
      <!--/.Panel - Green-->
      <div class="draggable-panel panel-sortable">
        <!--Panel - Blue-->
        <div class="panel-blue">
          <div class="panel-title-container">
            <div class="panel-icon">
              <i class="fa fa-file-text-o"></i>
            </div>
            <div class="panel-title">The Details</div>
            <div class="drag-icon">
              <i class="fa fa-arrows"></i>
            </div>
          </div>
          <div class="form-content form-horizontal">
            <div class="form-group draggable-form-fields">
              <!-- Loop for details -->
              <div class="col-xs-12 col-md-4 form-field">
                <label>
                  <span contenteditable="true">HISTORY</span>
                  <span class="inline-edit">
                    <a href="#">
                      <i class="fa fa-pencil"></i>
                    </a>
                    <a class="drag-icon-inner" href="javascript:void(0);">
                      <i class="fa fa-arrows"></i>
                    </a>
                  </span>
                </label>
                <textarea class="form-control" id="id" name="name" rows="1"></textarea>
              </div>
              <!-- end loop -->
              <div class="col-xs-12 col-md-4 form-field">
                <label>
                  <span contenteditable="true">NEW TOPIC</span>
                  <span class="inline-edit">
                    <a href="#">
                      <i class="fa fa-pencil"></i>
                    </a>
                    <a class="drag-icon-inner" href="javascript:void(0);">
                      <i class="fa fa-arrows"></i>
                    </a>
                  </span>
                </label>
                <textarea class="form-control" id="id" name="name" rows="1"></textarea>
                <a class="add-topic text-right" href="javascript:void(0);">
                  <i class="fa fa-plus-circle"></i>
                  ADD TOPIC</a>
              </div>
            </div>
          </div>
        </div>
        <!--/.Panel - Blue-->
        <!--Panel - Yellow-->
        <div class="panel-yellow">
          <div class="panel-title-container">
            <div class="panel-icon">
              <i class="fa fa-file-text-o"></i>
            </div>
            <div class="panel-title">The Other Stuff</div>
            <div class="drag-icon">
              <i class="fa fa-arrows"></i>
            </div>
          </div>
          <div class="form-content form-horizontal">
            <div class="form-group draggable-form-fields">
              <div class="col-xs-12 col-md-4 form-field">
                <label>
                  <span contenteditable="true">LAUNCH METHOD</span>
                  <span class="inline-edit">
                    <a href="#">
                      <i class="fa fa-pencil"></i>
                    </a>
                    <a class="drag-icon-inner" href="javascript:void(0);">
                      <i class="fa fa-arrows"></i>
                    </a>
                  </span>
                </label>
                <textarea class="form-control" id="id" name="name" rows="1"></textarea>
              </div>
              <div class="col-xs-12 col-md-4 form-field">
                <label>
                  <span contenteditable="true">HISTORY</span>
                  <span class="inline-edit">
                    <a href="#">
                      <i class="fa fa-pencil"></i>
                    </a>
                    <a class="drag-icon-inner" href="javascript:void(0);">
                      <i class="fa fa-arrows"></i>
                    </a>
                  </span>
                </label>
                <textarea class="form-control" id="id" name="name" rows="1"></textarea>
              </div>
              <div class="col-xs-12 col-md-4 form-field">
                <label>
                  <span contenteditable="true">EXTENSIONS</span>
                  <span class="inline-edit">
                    <a href="#">
                      <i class="fa fa-pencil"></i>
                    </a>
                    <a class="drag-icon-inner" href="javascript:void(0);">
                      <i class="fa fa-arrows"></i>
                    </a>
                  </span>
                </label>
                <textarea class="form-control" id="id" name="name" rows="1"></textarea>
              </div>
              <div class="col-xs-12 col-md-4 form-field">
                <label>
                  <span contenteditable="true">TEACHER MOVES</span>
                  <span class="inline-edit">
                    <a href="#">
                      <i class="fa fa-pencil"></i>
                    </a>
                    <a class="drag-icon-inner" href="javascript:void(0);">
                      <i class="fa fa-arrows"></i>
                    </a>
                  </span>
                </label>
                <textarea class="form-control" id="id" name="name" rows="1"></textarea>
              </div>
              <div class="col-xs-12 col-md-4 form-field">
                <label>
                  <span contenteditable="true">PATH</span>
                  <span class="inline-edit">
                    <a href="#">
                      <i class="fa fa-pencil"></i>
                    </a>
                    <a class="drag-icon-inner" href="javascript:void(0);">
                      <i class="fa fa-arrows"></i>
                    </a>
                  </span>
                </label>
                <textarea class="form-control" id="id" name="name" rows="1"></textarea>
              </div>
              <div class="col-xs-12 col-md-4 form-field">
                <label>
                  <span contenteditable="true">HINTS</span>
                  <span class="inline-edit">
                    <a href="#">
                      <i class="fa fa-pencil"></i>
                    </a>
                    <a class="drag-icon-inner" href="javascript:void(0);">
                      <i class="fa fa-arrows"></i>
                    </a>
                  </span>
                </label>
                <textarea class="form-control" id="id" name="name" rows="1"></textarea>
                <a class="add-topic text-right" href="javascript:void(0);">
                  <i class="fa fa-plus-circle"></i>
                  ADD TOPIC</a>
              </div>
            </div>
          </div>
        </div>
        <!--/.Panel - Yellow-->
      </div>
      <!--Panel - Grey-->
      <div class="panel-grey">
        <div class="panel-title-container">
          <div class="panel-icon">
            <i class="fa fa-file-text-o"></i>
          </div>
          <div class="panel-title">The Slider</div>
          <div class="drag-icon">
            <i class="fa fa-arrows"></i>
          </div>
        </div>
        <div class="form-content form-horizontal">
          <% 5.times do |i| %>
          <% f.simple_fields_for :slider_object do |builder| %>
          <div class="slide-item">
            <%= builder.input :resource, as: :hidden  %>
            <div class="slide-image-caption">SLIDE
              <%= i + 1 %></div>
            <!-- data-url attribute used to set ajax file upload path -->
            <div class="slide-image slide-upload" data-url="upload.php">
              <%= builder.input :resource, as: :file, class: "hidden" %>
            </div>
            <div class="slide-caption-text">CAPTION</div>
            <div class="slide-caption-input">
              <input class="form-control" type="text"/>
              <%= builder.input :description, label: false, input_html: { class: 'form-control' } %>
            </div>
          </div>
          <% end %>
          <% end %>
        </div>
      </div>
      <!--/.Panel - Grey-->
    </div>
    <!--/.Panel Content-->
  </div>
</div>
<% end %>
<script type="text/javascript">
  $(document).ready(function () {
    /**  Resources section - Fileupload Plugin Initialization**/
    $('#resources-upload .upload-trigger').on("click", function () {
      $('#resources-upload input[type="file"]').click(); // Simulate a click on the file input button to show the file browser dialog
    });

    $("#resources-upload").fileupload({
      url: $(this).attr('data-url'), // set server side upload file path
      dropZone: $('#resources-upload'), // This element will accept file drag/drop uploading
      add: function (e, data) {
        var jqXHR = data.submit(); // Automatically upload the file once it is added to the queue
      },
      done: function (e, data) {
        alert("File uploaded successfully"); // Callback for successful upload requests
      },
      fail: function (e, data) {
        alert("Error in file upload"); // Callback for successful upload requests
      }
    });

    /** Important Stuff section - Fileupload Plugin Initialization**/
    $('#important-stuff .upload-trigger').on("click", function () {
      $('#important-stuff-upload input[type="file"]').click(); // Simulate a click on the file input button to show the file browser dialog
    });

    $("#important-stuff-upload").fileupload({
      url: $(this).attr('data-url'), // set server side upload file path
      dropZone: $('#important-stuff-upload'), // This element will accept file drag/drop uploading
      add: function (e, data) {
        var jqXHR = data.submit(); // Automatically upload the file once it is added to the queue
      },
      done: function (e, data) {
        alert("File uploaded successfully"); // Callback for successful upload requests
      },
      fail: function (e, data) {
        alert("Error in file upload"); // Callback for successful upload requests
      }
    });

    /** The Slider section - Fileupload Plugin Initialization**/
    $('.slide-upload').on("click", function (e) {
      if ($(e.target).is('.slide-upload')) {
        $(this).children('input[type="file"]').click(); // Simulate a click on the file input button to show the file browser dialog
      }
    });
    $(".slide-upload").each(function (index, value) {
      $(".slide-upload:eq(" + index + ")").fileupload({
        url: $(this).attr('data-url'), // set server side upload file path
        dropZone: $(this), // This element will accept file drag/drop uploading
        add: function (e, data) {
          var jqXHR = data.submit(); // Automatically upload the file once it is added to the queue
        },
        done: function (e, data) {
          alert("File uploaded successfully"); // Callback for successful upload requests
        },
        fail: function (e, data) {
          alert("Error in file upload"); // Callback for successful upload requests
        }
      });
    });

    // Prevent the default action when a file is dropped on the window
    $(document).on('drop dragover', function (e) {
      e.preventDefault();
    });

    /** Sortable (or) movable  Plugin Initialization **/
    $('.panel-sortable').sortable({
      items: ':not(.sort-disabled)', //  to specifiy which items inside the element should be sortable:
      placeholderClass: 'placeholde-class',
      forcePlaceholderSize: true,
      hoverClass: 'is-hovered' // Defaults to false
      //handle: '.drag-icon' //to restrict drag start to the specified element:
    });

    draggableFormFields();

    function draggableFormFields() {
      $('.draggable-form-fields').sortable({
        forcePlaceholderSize: true, items: ':not(.sort-disabled)', //  to specifiy which items inside the element should be sortable:
        placeholderClass: 'placeholde-class',
        hoverClass: 'is-hovered' // Defaults to false
        //handle: '.drag-icon-inner' //to restrict drag start to the specified element:
      });
    }

    /** Add Dynamiv Formfield **/
    var formTemplate = '<div class="col-xs-12 col-md-4 form-field"><label><span contenteditable="true">NEW TOPIC</span><span class="inline-edit"><a href="#"><i class="fa fa-pencil"></i></a><a href="javascript:void(0);" class="drag-icon-inner"><i class="fa fa-arrows"></i></a' +
        '></span></label><textarea name="name" id="id" rows="1" class="form-control"></textarea><a href="javascript:void(0);" class="add-topic text-right"><i class="fa fa-plus-circle"></i> ADD TOPIC</a></div>';

    $('body').on('click', 'a.add-topic', function () {
      $(this).parent().after(formTemplate);
      $(this).remove();
      draggableFormFields(); // re-initialize draggable formfields
    });
  });
</script>
